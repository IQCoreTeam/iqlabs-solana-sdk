// Writer should be simpler than reader; decide how to plan it.
